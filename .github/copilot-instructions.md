# コーディング規約

このプロジェクトでは下記のコーディング規約に従ってください。

## チャット

- 指示に対して不明点があれば何度でも質問をしてください。
- 不明点が残っている状態でコーディング開始しないでください。
- 原因調査の指示の場合、原因特定後に即コーディング修正するのではなく、まずは調査結果を報告をして下さい。


## Python

### 関数

- 関数の複雑度（サイクロマティック複雑度）は10以内に抑えたコーディングを心掛けること。
- 既存の関数で複雑度10を超える関数があれば、改善案を提案の上、承認を受けてから改善を行うこと
  - 尚、本プロジェクトの`main()`は例外です。

### Docstring

- docstringは関数内に記述してください。
- docstringの1行は72文字までとする。
- 概要のみの1行、詳細な説明の複数行を記述する。
- 1行目は概要のみ簡潔に記述する。
- 複数行の場合は、空行を挟んで説明を記述する。
- 何をするのかの概要、パラメータ（Args:）、戻り値（Returns:）、発生する例外（Raises:）などについて記述すること。
- 記述内容は日本語で記述すること
- 以下はサンプルです。参考にして下さい。

```python
def add_received_data(session, rfid_value, loc_id_value, timestamp_value):
    """
    RFIDデータを受信データテーブルに追加する関数。
    RFIDやロケーションが存在しない場合は、新規にレコードを作成する。

    Args:
        session (Session): SQLAlchemyのセッションオブジェクト
        rfid_value (str): RFIDの値
        loc_id_value (str): ロケーションID
        timestamp_value (datetime): タイムスタンプ

    Raises:
        Exception: データベース操作中にエラーが発生した場合
    """
```

### コメント

- 複雑なロジックには必ず説明コメントを記述すること
- コメントは日本語で記述すること
- 過去の経緯、詳細な説明のコメントを勝手に消さないこと。消したい場合は必ず確認する事。

### エラーハンドリング

- 例外処理では具体的な例外クラスをキャッチすること
- `except Exception` は最後の手段として使用すること
- エラー発生時は必ずログ出力すること
- リソース（ファイル、DB接続）は必ずfinally節またはwith文で解放すること

### ログ出力

- ログレベルを適切に使い分けること
  - **DEBUG**: 開発時のデバッグ情報
  - **INFO**: 正常な処理の進行状況
  - **WARNING**: 警告レベルの問題
  - **ERROR**: エラーが発生したが処理継続可能
  - **CRITICAL**: システム停止レベルの重大エラー
- ログメッセージには処理対象のデータ（ID等）を含めること

### セキュリティ

- パスワードやAPIキーなどの機密情報はコード内にハードコーディングしないこと
- SQLインジェクション対策として、動的SQL生成は避けること
- ファイルパスの操作では、ディレクトリトラバーサル攻撃を防ぐためのバリデーションを行うこと

### パフォーマンス

- N+1問題を避けるため、ORMのクエリは適切に最適化すること
- 大量データ処理はバッチ処理またはストリーミング処理を使用すること
- DB接続は適切にプールを使用し、長時間保持しないこと
- ファイルI/Oでは適切なバッファサイズを設定すること
- 無限ループになる可能性がある処理には適切な終了条件を設けること

### テスト

- 新規関数には必ず単体テストを作成すること
- テストコードはルート直下のtestディレクトリに配置すること
- テストフレームワークはpytestを使用すること
- テスト関数名は「test_」で始めること
- 全体でC1のカバレッジを80%以上にすること
- DB接続は本番環境ではなくテスト用環境としてSQLiteを用いること



## JavaScript

### 命名規約

- 変数名、関数名はcamelCaseを使用すること
- 定数は大文字のSNAKE_CASEを使用すること
- クラス名はPascalCaseを使用すること
- プライベートメソッドは先頭に#を付けること（ES2022以降）
- ファイル名はkebab-caseを使用すること

### 構文規則

- セミコロンは必ず記述すること
- 文字列リテラルはシングルクォート（'）を使用すること
- テンプレートリテラルが必要な場合はバッククォート（`）を使用すること
- 厳密等価演算子（===、!==）を使用し、==、!=は使用しないこと
- `var` は使用せず、`const`、`let` を適切に使い分けること

### 関数

- 関数の複雑度は10以内に抑えること
- アロー関数と通常の関数を適切に使い分けること
- 非同期処理はasync/awaitを使用し、Promiseチェーンは避けること
- コールバック地獄を避けること

### エラーハンドリング

- try-catch文を適切に使用すること
- Promiseのエラーハンドリングは`.catch()`またはtry-catchで行うこと
- エラーオブジェクトには意味のあるメッセージを含めること

### コメント・ドキュメント

- JSDocコメントを使用すること
- `@param`, `@returns`, `@throws` などのタグを適切に使用すること
- 複雑なロジックには日本語でコメントを記述すること

**例:**
```javascript
/**
 * ユーザー情報を取得する関数
 * @param {number} userId - ユーザーID
 * @param {Object} options - オプション設定
 * @returns {Promise<Object>} ユーザー情報オブジェクト
 * @throws {Error} ユーザーが見つからない場合
 */
async function getUserInfo(userId, options = {}) {
    // 実装
}
```



## HTML

### 構造・セマンティクス

- HTML5のセマンティック要素を適切に使用すること
  （header, nav, main, article, section, aside, footer など）
- 見出しタグ（h1-h6）は階層を守って使用すること
- リストには適切なタグ（ul, ol, dl）を使用すること
- テーブルはデータ表示のみに使用し、レイアウトには使用しないこと

### 属性・命名

- class名、id名はkebab-caseを使用すること
- class名は機能や意味を表す名前を使用すること（見た目ではなく）
- id属性はページ内でユニークであることを保証すること
- alt属性は画像の内容を適切に説明すること
- form要素にはlabel要素を適切に関連付けること

### アクセシビリティ

- 適切なARIA属性を使用すること
- キーボードナビゲーションを考慮すること
- コントラスト比を適切に保つこと
- スクリーンリーダーでの読み上げを考慮すること

### パフォーマンス

- 画像には適切なalt属性と`loading="lazy"`を設定すること
- 不要なタグの入れ子を避けること
- インライン CSS/JavaScript は避けること

### コーディングスタイル

- インデントは2スペースを使用すること
- 属性値は必ずダブルクォート（"）で囲むこと
- 自己終了タグは適切に使用すること（`<img />`, `<br />` など）
- HTML要素は小文字で記述すること

**例:**
```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ページタイトル</title>
</head>
<body>
    <header class="site-header">
        <h1 class="site-title">サイトタイトル</h1>
        <nav class="main-navigation">
            <!-- ナビゲーション -->
        </nav>
    </header>
    
    <main class="main-content">
        <article class="content-article">
            <!-- メインコンテンツ -->
        </article>
    </main>
    
    <footer class="site-footer">
        <!-- フッター -->
    </footer>
</body>
</html>
```




## CSS

### 命名規約

- クラス名はkebab-caseを使用すること
- BEM記法の使用を推奨（Block__Element--Modifier）
- IDセレクタは避け、クラスセレクタを使用すること

### 構造

- ファイルは機能や役割ごとに分割すること
- インポート順序を統一すること（リセット → ベース → コンポーネント → ページ固有）
- ネストは3階層以内に抑えること

### プロパティ

- プロパティは機能別にグループ化して記述すること
- ベンダープレフィックスは適切に使用すること
- 単位は相対単位（rem, %, vw など）を優先すること



---

**Copilotへの指示**:
常に本規約に従ったコードを生成してください。違反がないか提案時・コードレビュー時によく確認してください。
